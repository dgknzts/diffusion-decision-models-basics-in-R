<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
  <base href="https://dgknzts.github.io/drift-diffusion-model-basics-in-R/">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exploring Across-Trial Parameter Variability in the DDM • DDM_Basics_R</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exploring Across-Trial Parameter Variability in the DDM">
<meta name="description" content="Simulate and visualize the effects of parameter variability in the DDM.">
<meta property="og:description" content="Simulate and visualize the effects of parameter variability in the DDM.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DDM_Basics_R</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/shiny_app.html">Interactive Demo</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Exploring Across-Trial Parameter Variability in the DDM</h1>
                        <h4 data-toc-skip class="author">Dogukan Nami
Oztas</h4>
            
            <h4 data-toc-skip class="date">2025-05-16</h4>
      

      <div class="d-none name"><code>03_parameter_variability_in_ddm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-across-trial-parameter-variability">Introduction to Across-Trial Parameter Variability<a class="anchor" aria-label="anchor" href="#introduction-to-across-trial-parameter-variability"></a>
</h2>
<p>In the basic Diffusion Decision Model (DDM), core parameters like
drift rate (v), starting point (z), and non-decision time (ter) are
often assumed to be constant across all trials within an experimental
condition. However, empirical evidence and theoretical considerations
suggest that these parameters can fluctuate from one trial to the next.
Incorporating this <strong>across-trial parameter variability</strong>
makes the DDM more realistic and often improves its ability to fit
complex patterns in behavioral data.</p>
<p><strong>Why is Variability Important?</strong></p>
<ul>
<li><p><strong>More Realistic RT Distributions:</strong> Variability,
especially in drift rate (sv) and non-decision time (st0), helps capture
the full shape of empirical RT distributions, including their
characteristic skewness and the spread of the leading edge.</p></li>
<li><p><strong>Explaining Error RTs:</strong> The relationship between
correct and error RTs (e.g., errors being sometimes faster or slower
than corrects) is often better explained when considering variability in
drift rate (sv) and starting point (sz).</p></li>
<li><p><strong>Accounting for Fluctuations:</strong> Human cognitive
processes are inherently noisy and subject to fluctuations in attention,
motivation, and processing efficiency. Parameter variability provides a
way to model these fluctuations.</p></li>
</ul>
<p>This vignette demonstrates how to simulate the DDM with across-trial
variability using the functions in R/03_ddm_simulator_variable.R.</p>
</div>
<div class="section level2">
<h2 id="simulating-ddm-with-parameter-variability">Simulating DDM with Parameter Variability<a class="anchor" aria-label="anchor" href="#simulating-ddm-with-parameter-variability"></a>
</h2>
<p>We have two key functions for this:</p>
<ul>
<li><p>simulate_diffusion_trial_variable(): Simulates a single DDM trial
where v, z, and ter are sampled from distributions.</p></li>
<li><p>simulate_diffusion_experiment_variable(): Simulates multiple
trials using simulate_diffusion_trial_variable().</p></li>
</ul>
<p><strong>Variability Parameters:</strong></p>
<ul>
<li><p><strong>sv (Drift Rate Variability):</strong> Standard deviation
of a Normal distribution from which the trial-specific drift rate
(v_trial) is sampled: v_trial ~ Normal(mean_v, sv).</p></li>
<li><p><strong>sz (Starting Point Variability):</strong> Range of a
Uniform distribution for z_trial: z_trial ~ Uniform(mean_z - sz/2,
mean_z + sz/2). The sampled z_trial is clipped to stay within (0,
a).</p></li>
<li><p><strong>st0 (Non-Decision Time Variability):</strong> Range of a
Uniform distribution for ter_trial: ter_trial ~ Uniform(mean_ter -
st0/2, mean_ter + st0/2). The sampled ter_trial is clipped to be
non-negative.</p></li>
</ul>
<p>If a variability parameter (e.g., sv) is set to 0, the corresponding
model parameter (v_trial) will take its mean value (mean_v) for all
trials.</p>
<div class="section level3">
<h3 id="example-simulating-an-experiment-with-variability">Example: Simulating an Experiment with Variability<a class="anchor" aria-label="anchor" href="#example-simulating-an-experiment-with-variability"></a>
</h3>
<p>Let’s simulate an experiment with variability in all three parameters
(v, z, ter).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">303</span><span class="op">)</span> <span class="co"># For reproducibility</span></span>
<span><span class="va">n_var_trials</span> <span class="op">&lt;-</span> <span class="fl">2000</span> <span class="co"># Sufficient trials for distribution shapes</span></span>
<span></span>
<span><span class="co"># Parameters for the variable DDM simulation</span></span>
<span><span class="va">var_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  mean_v <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  a <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  mean_z <span class="op">=</span> <span class="fl">0.5</span>,    <span class="co"># Mean starting point (a/2 for unbiased)</span></span>
<span>  s <span class="op">=</span> <span class="fl">0.3</span>,         <span class="co"># Within-trial noise (constant)</span></span>
<span>  mean_ter <span class="op">=</span> <span class="fl">0.1</span>,  <span class="co"># Mean non-decision time</span></span>
<span>  sv <span class="op">=</span> <span class="fl">0.2</span>,        <span class="co"># SD of drift rate variability</span></span>
<span>  sz <span class="op">=</span> <span class="fl">0.2</span>,        <span class="co"># Range of starting point variability (z from 0.4 to 0.6)</span></span>
<span>  st0 <span class="op">=</span> <span class="fl">0.05</span>,      <span class="co"># Range of non-decision time variability</span></span>
<span>  dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ddm_data_variable</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment_variable</span><span class="op">(</span></span>
<span>  n_trials <span class="op">=</span> <span class="va">n_var_trials</span>,</span>
<span>  mean_v <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">mean_v</span>,</span>
<span>  a <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">a</span>,</span>
<span>  mean_z <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">mean_z</span>,</span>
<span>  s <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">s</span>,</span>
<span>  mean_ter <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">mean_ter</span>,</span>
<span>  sv <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">sv</span>,</span>
<span>  sz <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">sz</span>,</span>
<span>  st0 <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">st0</span>,</span>
<span>  dt <span class="op">=</span> <span class="va">var_params</span><span class="op">$</span><span class="va">dt</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ddm_data_variable</span><span class="op">)</span>, caption <span class="op">=</span> <span class="st">"First 6 trials from DDM with parameter variability."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>First 6 trials from DDM with parameter variability.</caption>
<colgroup>
<col width="8%">
<col width="10%">
<col width="13%">
<col width="20%">
<col width="16%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">trial</th>
<th align="right">choice</th>
<th align="right">rt</th>
<th align="right">decision_time</th>
<th align="right">v_trial</th>
<th align="right">z_trial</th>
<th align="right">ter_trial</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4.741999</td>
<td align="right">4.63</td>
<td align="right">0.0006122</td>
<td align="right">0.5219631</td>
<td align="right">0.1119988</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1.538572</td>
<td align="right">1.42</td>
<td align="right">0.0774412</td>
<td align="right">0.4739782</td>
<td align="right">0.1185719</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0.864889</td>
<td align="right">0.78</td>
<td align="right">-0.1528199</td>
<td align="right">0.5746136</td>
<td align="right">0.0848890</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0</td>
<td align="right">1.214346</td>
<td align="right">1.12</td>
<td align="right">-0.1148261</td>
<td align="right">0.4718828</td>
<td align="right">0.0943463</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1.162694</td>
<td align="right">1.08</td>
<td align="right">0.1351808</td>
<td align="right">0.5701450</td>
<td align="right">0.0826937</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0</td>
<td align="right">1.468756</td>
<td align="right">1.39</td>
<td align="right">0.0335632</td>
<td align="right">0.5451873</td>
<td align="right">0.0787557</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ddm_data_variable</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"choice"</span>, <span class="st">"rt"</span>, <span class="st">"v_trial"</span>, <span class="st">"z_trial"</span>, <span class="st">"ter_trial"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      choice             rt            v_trial            z_trial      </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.2164   Min.   :-0.56052   Min.   :0.4000  </span></span>
<span><span class="co">##  1st Qu.:0.0000   1st Qu.:1.0149   1st Qu.:-0.03097   1st Qu.:0.4505  </span></span>
<span><span class="co">##  Median :1.0000   Median :1.6323   Median : 0.10460   Median :0.5027  </span></span>
<span><span class="co">##  Mean   :0.6703   Mean   :1.9051   Mean   : 0.10364   Mean   :0.5012  </span></span>
<span><span class="co">##  3rd Qu.:1.0000   3rd Qu.:2.5858   3rd Qu.: 0.23130   3rd Qu.:0.5506  </span></span>
<span><span class="co">##  Max.   :1.0000   Max.   :5.1133   Max.   : 0.76949   Max.   :0.5999  </span></span>
<span><span class="co">##  NA's   :171      NA's   :171                                         </span></span>
<span><span class="co">##    ter_trial      </span></span>
<span><span class="co">##  Min.   :0.07500  </span></span>
<span><span class="co">##  1st Qu.:0.08680  </span></span>
<span><span class="co">##  Median :0.09994  </span></span>
<span><span class="co">##  Mean   :0.09971  </span></span>
<span><span class="co">##  3rd Qu.:0.11227  </span></span>
<span><span class="co">##  Max.   :0.12499  </span></span>
<span><span class="co">## </span></span></code></pre>
<p>The output data frame now includes v_trial, z_trial, and ter_trial,
showing the specific parameter values used for each simulated trial.</p>
</div>
<div class="section level3">
<h3 id="visualizing-sampled-trial-parameters">Visualizing Sampled Trial Parameters<a class="anchor" aria-label="anchor" href="#visualizing-sampled-trial-parameters"></a>
</h3>
<p>We can plot histograms of the sampled parameters to verify they are
drawn from the intended distributions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reshape data for easier plotting with ggplot2 (optional, could do separate plots)</span></span>
<span><span class="va">params_long</span> <span class="op">&lt;-</span> <span class="va">ddm_data_variable</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">v_trial</span>, <span class="va">z_trial</span>, <span class="va">ter_trial</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"parameter"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">params_long</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Plot density for better comparison of shapes</span></span>
<span>                 fill <span class="op">=</span> <span class="st">"cornflowerblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">parameter</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Separate plot for each parameter</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distributions of Sampled Trial-Specific Parameters"</span>, x <span class="op">=</span> <span class="st">"Parameter Value"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="03_parameter_variability_in_ddm_files/figure-html/unnamed-chunk-2-1.png" alt="Histograms of sampled trial parameters showing distributions of drift rate, starting point, and non-decision time across trials" width="700" style="display: block; margin: auto;"></p>
<ul>
<li><p>v_trial should approximate a Normal distribution.</p></li>
<li><p>z_trial and ter_trial should approximate Uniform distributions
over their respective ranges (after accounting for any
clipping).</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="impact-of-parameter-variability-on-rt-distributions">Impact of Parameter Variability on RT Distributions<a class="anchor" aria-label="anchor" href="#impact-of-parameter-variability-on-rt-distributions"></a>
</h2>
<p>Let’s compare the RT distributions generated by a DDM with
across-trial parameter variability to one without it (i.e., a “standard”
DDM where v, z, and ter are fixed across trials).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameters for comparison to highlight skewness</span></span>
<span><span class="va">n_comp_trials</span> <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Increase number of trials</span></span>
<span></span>
<span><span class="co"># Standard DDM parameters</span></span>
<span><span class="va">std_v</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">std_a</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">std_z</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">std_s</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">std_ter</span> <span class="op">&lt;-</span> <span class="fl">0.15</span></span>
<span></span>
<span><span class="co"># Variable DDM parameters (same means, but with variability)</span></span>
<span><span class="va">var_mean_v</span> <span class="op">&lt;-</span> <span class="va">std_v</span></span>
<span><span class="va">var_a</span> <span class="op">&lt;-</span> <span class="va">std_a</span></span>
<span><span class="va">var_mean_z</span> <span class="op">&lt;-</span> <span class="va">std_z</span></span>
<span><span class="va">var_s</span> <span class="op">&lt;-</span> <span class="va">std_s</span></span>
<span><span class="va">var_mean_ter</span> <span class="op">&lt;-</span> <span class="va">std_ter</span></span>
<span><span class="va">var_sv</span> <span class="op">&lt;-</span> <span class="fl">0.20</span>  <span class="co"># &lt;&lt;--- KEY: Increased sv for more pronounced skew</span></span>
<span><span class="va">var_sz</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>   <span class="co"># Moderate sz</span></span>
<span><span class="va">var_st0</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># Moderate st0</span></span>
<span></span>
<span><span class="co"># Simulate Standard DDM</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">305</span><span class="op">)</span> <span class="co"># New seed for new simulation</span></span>
<span><span class="va">ddm_data_standard_skew</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment</span><span class="op">(</span></span>
<span>  n_trials <span class="op">=</span> <span class="va">n_comp_trials</span>,</span>
<span>  v <span class="op">=</span> <span class="va">std_v</span>,</span>
<span>  a <span class="op">=</span> <span class="va">std_a</span>,</span>
<span>  z <span class="op">=</span> <span class="va">std_z</span>,</span>
<span>  s <span class="op">=</span> <span class="va">std_s</span>,</span>
<span>  ter <span class="op">=</span> <span class="va">std_ter</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.01</span> <span class="co"># Assuming dt is handled in your function, else add it</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate DDM with Variability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">305</span><span class="op">)</span> <span class="co"># Use the same seed for the variable part for closer comparison</span></span>
<span><span class="va">ddm_data_variable_skew</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment_variable</span><span class="op">(</span></span>
<span>  n_trials <span class="op">=</span> <span class="va">n_comp_trials</span>,</span>
<span>  mean_v <span class="op">=</span> <span class="va">var_mean_v</span>,</span>
<span>  a <span class="op">=</span> <span class="va">var_a</span>,</span>
<span>  mean_z <span class="op">=</span> <span class="va">var_mean_z</span>,</span>
<span>  s <span class="op">=</span> <span class="va">var_s</span>,</span>
<span>  mean_ter <span class="op">=</span> <span class="va">var_mean_ter</span>,</span>
<span>  sv <span class="op">=</span> <span class="va">var_sv</span>,</span>
<span>  sz <span class="op">=</span> <span class="va">var_sz</span>,</span>
<span>  st0 <span class="op">=</span> <span class="va">var_st0</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.01</span> <span class="co"># Assuming dt is handled in your function</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a 'model_type' column</span></span>
<span><span class="va">ddm_data_standard_skew</span><span class="op">$</span><span class="va">model_type</span> <span class="op">&lt;-</span> <span class="st">"Standard DDM"</span></span>
<span><span class="va">ddm_data_variable_skew</span><span class="op">$</span><span class="va">model_type</span> <span class="op">&lt;-</span> <span class="st">"DDM with Variability"</span></span>
<span></span>
<span><span class="co"># Combine data</span></span>
<span><span class="va">combined_plot_data_skew</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="va">ddm_data_standard_skew</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">rt</span>, <span class="va">choice</span>, <span class="va">model_type</span><span class="op">)</span>,</span>
<span>  <span class="va">ddm_data_variable_skew</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">rt</span>, <span class="va">choice</span>, <span class="va">model_type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>choice_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">choice</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Choice 0 (e.g., Error)"</span>, <span class="st">"Choice 1 (e.g., Correct)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Mean and Median to numerically check skewness</span></span>
<span><span class="va">summary_stats_skew</span> <span class="op">&lt;-</span> <span class="va">combined_plot_data_skew</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">model_type</span>, <span class="va">choice_label</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    N <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    Mean_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Median_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">rt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    SD_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">rt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Skewness_coeff <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">N</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html" class="external-link">skewness</a></span><span class="op">(</span><span class="va">rt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="kw">else</span> <span class="cn">NA</span> <span class="co"># Requires 'moments' package</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Summary Statistics for RTs (Mean &gt; Median indicates right skew):"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Summary Statistics for RTs (Mean &gt; Median indicates right skew):"</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_stats_skew</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="23%">
<col width="27%">
<col width="5%">
<col width="8%">
<col width="11%">
<col width="6%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">model_type</th>
<th align="left">choice_label</th>
<th align="right">N</th>
<th align="right">Mean_RT</th>
<th align="right">Median_RT</th>
<th align="right">SD_RT</th>
<th align="right">Skewness_coeff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DDM with Variability</td>
<td align="left">Choice 0 (e.g., Error)</td>
<td align="right">1350</td>
<td align="right">2.364</td>
<td align="right">2.150</td>
<td align="right">1.166</td>
<td align="right">0.580</td>
</tr>
<tr class="even">
<td align="left">DDM with Variability</td>
<td align="left">Choice 1 (e.g., Correct)</td>
<td align="right">2914</td>
<td align="right">2.064</td>
<td align="right">1.783</td>
<td align="right">1.122</td>
<td align="right">0.835</td>
</tr>
<tr class="odd">
<td align="left">Standard DDM</td>
<td align="left">Choice 0 (e.g., Error)</td>
<td align="right">648</td>
<td align="right">2.510</td>
<td align="right">2.370</td>
<td align="right">1.173</td>
<td align="right">0.370</td>
</tr>
<tr class="even">
<td align="left">Standard DDM</td>
<td align="left">Choice 1 (e.g., Correct)</td>
<td align="right">3318</td>
<td align="right">2.506</td>
<td align="right">2.310</td>
<td align="right">1.167</td>
<td align="right">0.404</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot density distributions</span></span>
<span><span class="co"># Adjust xlim to see the tails better</span></span>
<span><span class="va">rt_upper_quantile_for_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">combined_plot_data_skew</span><span class="op">$</span><span class="va">rt</span>, <span class="fl">0.99</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Show 99% of data</span></span>
<span></span>
<span><span class="va">p_rt_comparison_skew</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">combined_plot_data_skew</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">model_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Removed color=model_type for clearer fill</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">model_type</span> <span class="op">~</span> <span class="va">choice_label</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Facet by model_type rows, choice_label columns</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comparison of RT Distributions: Impact of Parameter Variability"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"sv ="</span>, <span class="va">var_sv</span>, <span class="st">", sz ="</span>, <span class="va">var_sz</span>, <span class="st">", st0 ="</span>, <span class="va">var_st0</span>, <span class="st">"for Variable DDM"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Reaction Time (s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Model Type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">rt_upper_quantile_for_plot</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Zoom appropriately</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Using theme_bw for clearer facets</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>, <span class="co"># Make facet labels clearer</span></span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_rt_comparison_skew</span><span class="op">)</span></span></code></pre></div>
<p><img src="03_parameter_variability_in_ddm_files/figure-html/unnamed-chunk-3-1.png" alt="Density plots comparing reaction time distributions between standard DDM and DDM with parameter variability, showing how variability affects distribution shape and skewness" width="700" style="display: block; margin: auto;"></p>
<p><strong>Observations from the Comparison:</strong></p>
<ul>
<li><p><strong>Skewness:</strong> The DDM with parameter variability
(especially sv) typically produces RT distributions that are more
positively skewed (longer right tail) than the standard DDM.</p></li>
<li><p><strong>Leading Edge:</strong> st0 (variability in non-decision
time) will tend to spread out the leading edge (fastest RTs) of the
distribution.</p></li>
<li><p><strong>Error RTs:</strong> The relationship between correct RTs
and error RTs can change significantly. For example, sv can lead to
“slow errors” (errors are slower than corrects) if, on some trials, the
drift rate is small or even slightly in the wrong direction. sz can
contribute to “fast errors” if the starting point happens to be close to
the incorrect boundary.</p></li>
<li><p><strong>Overall Fit:</strong> For real data, models incorporating
these variabilities often provide a substantially better quantitative
fit.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="exploring-individual-variability-components">Exploring Individual Variability Components<a class="anchor" aria-label="anchor" href="#exploring-individual-variability-components"></a>
</h2>
<p>To better understand how each source of across-trial variability
affects the model’s predictions, we can simulate scenarios where only
one variability parameter is non-zero at a time. We will compare these
to our ddm_data_standard_skew (simulated earlier with no across-trial
variability) as a baseline.</p>
<p><strong>Parameters for these focused simulations:</strong><br>
(We’ll use the same mean parameters as in the previous comparison for
consistency, and a common number of trials.)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These should match the parameters used for ddm_data_standard_skew</span></span>
<span><span class="co"># Or redefine them if this section is run independently</span></span>
<span><span class="va">n_iso_trials</span> <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Number of trials for each isolated simulation</span></span>
<span></span>
<span><span class="co"># Base mean parameters (same as previous comparison)</span></span>
<span><span class="va">base_mean_v</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">base_a</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">base_mean_z</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">base_s</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">base_mean_ter</span> <span class="op">&lt;-</span> <span class="fl">0.15</span></span>
<span><span class="va">base_dt</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span></span>
<span><span class="co"># Magnitude of variability to explore for each component</span></span>
<span><span class="va">iso_sv_val</span> <span class="op">&lt;-</span> <span class="fl">0.40</span></span>
<span><span class="va">iso_sz_val</span> <span class="op">&lt;-</span> <span class="fl">0.40</span> <span class="co"># Range for z: mean_z +/- 0.1</span></span>
<span><span class="va">iso_st0_val</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="co"># Range for ter: mean_ter +/- 0.05</span></span>
<span></span>
<span><span class="co"># Re-simulate standard DDM if not available or to ensure consistency with n_iso_trials</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">305</span><span class="op">)</span> <span class="co"># Match seed from previous standard sim if desired</span></span>
<span><span class="va">ddm_data_standard_iso</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment</span><span class="op">(</span></span>
<span>  n_trials <span class="op">=</span> <span class="va">n_iso_trials</span>,</span>
<span>  v <span class="op">=</span> <span class="va">base_mean_v</span>, a <span class="op">=</span> <span class="va">base_a</span>, z <span class="op">=</span> <span class="va">base_mean_z</span>,</span>
<span>  s <span class="op">=</span> <span class="va">base_s</span>, ter <span class="op">=</span> <span class="va">base_mean_ter</span>, dt <span class="op">=</span> <span class="va">base_dt</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ddm_data_standard_iso</span><span class="op">$</span><span class="va">model_type</span> <span class="op">&lt;-</span> <span class="st">"Standard DDM (No Variability)"</span></span></code></pre></div>
<div class="section level4">
<h4 id="effect-of-drift-rate-variability-sv-only">
<strong>1. Effect of Drift Rate Variability (sv) Only</strong><a class="anchor" aria-label="anchor" href="#effect-of-drift-rate-variability-sv-only"></a>
</h4>
<p>Drift rate variability (sv) is often the most impactful, particularly
on the overall skew of RT distributions and the characteristics of error
responses.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">401</span><span class="op">)</span> <span class="co"># New seed for this specific simulation</span></span>
<span><span class="va">ddm_data_sv_only</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment_variable</span><span class="op">(</span></span>
<span>  n_trials <span class="op">=</span> <span class="va">n_iso_trials</span>,</span>
<span>  mean_v <span class="op">=</span> <span class="va">base_mean_v</span>, a <span class="op">=</span> <span class="va">base_a</span>, mean_z <span class="op">=</span> <span class="va">base_mean_z</span>,</span>
<span>  s <span class="op">=</span> <span class="va">base_s</span>, mean_ter <span class="op">=</span> <span class="va">base_mean_ter</span>, dt <span class="op">=</span> <span class="va">base_dt</span>,</span>
<span>  sv <span class="op">=</span> <span class="va">iso_sv_val</span>,  <span class="co"># Only sv is non-zero</span></span>
<span>  sz <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  st0 <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ddm_data_sv_only</span><span class="op">$</span><span class="va">model_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Only sv = "</span>, <span class="va">iso_sv_val</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine with standard for plotting</span></span>
<span><span class="va">combined_sv_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="va">ddm_data_standard_iso</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">rt</span>, <span class="va">choice</span>, <span class="va">model_type</span><span class="op">)</span>,</span>
<span>  <span class="va">ddm_data_sv_only</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">rt</span>, <span class="va">choice</span>, <span class="va">model_type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>choice_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">choice</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Choice 0"</span>, <span class="st">"Choice 1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">p_sv_effect</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">combined_sv_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">model_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">model_type</span> <span class="op">~</span> <span class="va">choice_label</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Impact of Drift Rate Variability (sv) Only"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Comparing Standard DDM to DDM with sv ="</span>, <span class="va">iso_sv_val</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Reaction Time (s)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, fill <span class="op">=</span> <span class="st">"Model Type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">combined_sv_data</span><span class="op">$</span><span class="va">rt</span>, <span class="fl">0.99</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>, strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_sv_effect</span><span class="op">)</span></span></code></pre></div>
<p><img src="03_parameter_variability_in_ddm_files/figure-html/unnamed-chunk-5-1.png" alt="Density plots showing the specific effect of drift rate variability (sv) on reaction time distributions, comparing standard DDM to DDM with sv only" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary Stats</span></span>
<span><span class="va">summary_sv</span> <span class="op">&lt;-</span> <span class="va">combined_sv_data</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">model_type</span>, <span class="va">choice_label</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>N<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>, Mean_RT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>, Median_RT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>, .groups<span class="op">=</span><span class="st">"drop"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_sv</span>, caption <span class="op">=</span> <span class="st">"RT Summary: sv effect"</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>RT Summary: sv effect</caption>
<thead><tr class="header">
<th align="left">model_type</th>
<th align="left">choice_label</th>
<th align="right">N</th>
<th align="right">Mean_RT</th>
<th align="right">Median_RT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Only sv = 0.4</td>
<td align="left">Choice 0</td>
<td align="right">1720</td>
<td align="right">1.957</td>
<td align="right">1.62</td>
</tr>
<tr class="even">
<td align="left">Only sv = 0.4</td>
<td align="left">Choice 1</td>
<td align="right">2684</td>
<td align="right">1.723</td>
<td align="right">1.39</td>
</tr>
<tr class="odd">
<td align="left">Standard DDM (No Variability)</td>
<td align="left">Choice 0</td>
<td align="right">245</td>
<td align="right">2.857</td>
<td align="right">2.74</td>
</tr>
<tr class="even">
<td align="left">Standard DDM (No Variability)</td>
<td align="left">Choice 1</td>
<td align="right">3198</td>
<td align="right">2.810</td>
<td align="right">2.68</td>
</tr>
</tbody>
</table>
<p><strong>Expected Observation:</strong> With sv &gt; 0, the RT
distributions (especially for the choice favored by mean_v) should
become more right-skewed compared to the standard DDM. You might also
see more “slow errors” if sv is large enough for v_trial to sometimes be
near zero or negative.</p>
</div>
<div class="section level4">
<h4 id="effect-of-starting-point-variability-sz-only">
<strong>2. Effect of Starting Point Variability (sz)
Only</strong><a class="anchor" aria-label="anchor" href="#effect-of-starting-point-variability-sz-only"></a>
</h4>
<p>Starting point variability (sz) primarily influences the probability
of fast errors and can slightly affect the overall RT distribution
shape.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">402</span><span class="op">)</span></span>
<span><span class="va">ddm_data_sz_only</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment_variable</span><span class="op">(</span></span>
<span>  n_trials <span class="op">=</span> <span class="va">n_iso_trials</span>,</span>
<span>  mean_v <span class="op">=</span> <span class="va">base_mean_v</span>, a <span class="op">=</span> <span class="va">base_a</span>, mean_z <span class="op">=</span> <span class="va">base_mean_z</span>,</span>
<span>  s <span class="op">=</span> <span class="va">base_s</span>, mean_ter <span class="op">=</span> <span class="va">base_mean_ter</span>, dt <span class="op">=</span> <span class="va">base_dt</span>,</span>
<span>  sv <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sz <span class="op">=</span> <span class="va">iso_sz_val</span>,  <span class="co"># Only sz is non-zero</span></span>
<span>  st0 <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ddm_data_sz_only</span><span class="op">$</span><span class="va">model_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Only sz = "</span>, <span class="va">iso_sz_val</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_sz_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="va">ddm_data_standard_iso</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">rt</span>, <span class="va">choice</span>, <span class="va">model_type</span><span class="op">)</span>,</span>
<span>  <span class="va">ddm_data_sz_only</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">rt</span>, <span class="va">choice</span>, <span class="va">model_type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>choice_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">choice</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Choice 0"</span>, <span class="st">"Choice 1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_sz_effect</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">combined_sz_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">model_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">model_type</span> <span class="op">~</span> <span class="va">choice_label</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Impact of Starting Point Variability (sz) Only"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Comparing Standard DDM to DDM with sz ="</span>, <span class="va">iso_sz_val</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Reaction Time (s)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, fill <span class="op">=</span> <span class="st">"Model Type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">combined_sz_data</span><span class="op">$</span><span class="va">rt</span>, <span class="fl">0.99</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>, strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_sz_effect</span><span class="op">)</span></span></code></pre></div>
<p><img src="03_parameter_variability_in_ddm_files/figure-html/unnamed-chunk-6-1.png" alt="Density plots showing the specific effect of starting point variability (sz) on reaction time distributions, comparing standard DDM to DDM with sz only" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_sz</span> <span class="op">&lt;-</span> <span class="va">combined_sz_data</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">model_type</span>, <span class="va">choice_label</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>N<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>, Mean_RT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>, Median_RT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>, .groups<span class="op">=</span><span class="st">"drop"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_sz</span>, caption <span class="op">=</span> <span class="st">"RT Summary: sz effect"</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>RT Summary: sz effect</caption>
<thead><tr class="header">
<th align="left">model_type</th>
<th align="left">choice_label</th>
<th align="right">N</th>
<th align="right">Mean_RT</th>
<th align="right">Median_RT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Only sz = 0.4</td>
<td align="left">Choice 0</td>
<td align="right">330</td>
<td align="right">2.440</td>
<td align="right">2.275</td>
</tr>
<tr class="even">
<td align="left">Only sz = 0.4</td>
<td align="left">Choice 1</td>
<td align="right">3137</td>
<td align="right">2.738</td>
<td align="right">2.640</td>
</tr>
<tr class="odd">
<td align="left">Standard DDM (No Variability)</td>
<td align="left">Choice 0</td>
<td align="right">245</td>
<td align="right">2.857</td>
<td align="right">2.740</td>
</tr>
<tr class="even">
<td align="left">Standard DDM (No Variability)</td>
<td align="left">Choice 1</td>
<td align="right">3198</td>
<td align="right">2.810</td>
<td align="right">2.680</td>
</tr>
</tbody>
</table>
<p><strong>Expected Observation:</strong> sz &gt; 0 can lead to a slight
increase in the variance of RTs. More notably, if mean_v strongly favors
one response, sz can increase the likelihood of fast errors for the
other response (if z_trial happens to start closer to that incorrect
boundary). The overall skew might not change as dramatically as with
sv.</p>
</div>
<div class="section level4">
<h4 id="effect-of-non-decision-time-variability-st0-only">
<strong>3. Effect of Non-Decision Time Variability (st0)
Only</strong><a class="anchor" aria-label="anchor" href="#effect-of-non-decision-time-variability-st0-only"></a>
</h4>
<p>Non-decision time variability (st0) primarily affects the spread of
the leading edge (fastest part) of the RT distribution.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">403</span><span class="op">)</span></span>
<span><span class="va">ddm_data_st0_only</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment_variable</span><span class="op">(</span></span>
<span>  n_trials <span class="op">=</span> <span class="va">n_iso_trials</span>,</span>
<span>  mean_v <span class="op">=</span> <span class="va">base_mean_v</span>, a <span class="op">=</span> <span class="va">base_a</span>, mean_z <span class="op">=</span> <span class="va">base_mean_z</span>,</span>
<span>  s <span class="op">=</span> <span class="va">base_s</span>, mean_ter <span class="op">=</span> <span class="va">base_mean_ter</span>, dt <span class="op">=</span> <span class="va">base_dt</span>,</span>
<span>  sv <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sz <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  st0 <span class="op">=</span> <span class="va">iso_st0_val</span>  <span class="co"># Only st0 is non-zero</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ddm_data_st0_only</span><span class="op">$</span><span class="va">model_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Only st0 = "</span>, <span class="va">iso_st0_val</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_st0_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="va">ddm_data_standard_iso</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">rt</span>, <span class="va">choice</span>, <span class="va">model_type</span><span class="op">)</span>,</span>
<span>  <span class="va">ddm_data_st0_only</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">rt</span>, <span class="va">choice</span>, <span class="va">model_type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>choice_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">choice</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Choice 0"</span>, <span class="st">"Choice 1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_st0_effect</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">combined_st0_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">model_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">model_type</span> <span class="op">~</span> <span class="va">choice_label</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Facet by model_type and choice</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Impact of Non-Decision Time Variability (st0) Only"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Comparing Standard DDM to DDM with st0 ="</span>, <span class="va">iso_st0_val</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Reaction Time (s)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, fill <span class="op">=</span> <span class="st">"Model Type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">combined_st0_data</span><span class="op">$</span><span class="va">rt</span>, <span class="fl">0.99</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>, strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_st0_effect</span><span class="op">)</span></span></code></pre></div>
<p><img src="03_parameter_variability_in_ddm_files/figure-html/unnamed-chunk-7-1.png" alt="Density plots showing the specific effect of non-decision time variability (st0) on reaction time distributions, comparing standard DDM to DDM with st0 only" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_st0</span> <span class="op">&lt;-</span> <span class="va">combined_st0_data</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">model_type</span>, <span class="va">choice_label</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>N<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>, Mean_RT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>, Median_RT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>, .groups<span class="op">=</span><span class="st">"drop"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_st0</span>, caption <span class="op">=</span> <span class="st">"RT Summary: st0 effect"</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>RT Summary: st0 effect</caption>
<thead><tr class="header">
<th align="left">model_type</th>
<th align="left">choice_label</th>
<th align="right">N</th>
<th align="right">Mean_RT</th>
<th align="right">Median_RT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Only st0 = 0.3</td>
<td align="left">Choice 0</td>
<td align="right">264</td>
<td align="right">2.740</td>
<td align="right">2.541</td>
</tr>
<tr class="even">
<td align="left">Only st0 = 0.3</td>
<td align="left">Choice 1</td>
<td align="right">3188</td>
<td align="right">2.790</td>
<td align="right">2.684</td>
</tr>
<tr class="odd">
<td align="left">Standard DDM (No Variability)</td>
<td align="left">Choice 0</td>
<td align="right">245</td>
<td align="right">2.857</td>
<td align="right">2.740</td>
</tr>
<tr class="even">
<td align="left">Standard DDM (No Variability)</td>
<td align="left">Choice 1</td>
<td align="right">3198</td>
<td align="right">2.810</td>
<td align="right">2.680</td>
</tr>
</tbody>
</table>
<p><strong>Expected Observation:</strong> With st0 &gt; 0, the RT
distributions should look “smeared out” more uniformly, especially at
the fast end. The minimum RT will be effectively mean_ter - st0/2 (plus
minimum decision time), and the overall distribution will be a
convolution of the decision time distribution and the uniform ter
distribution. It tends to make the entire distribution wider without
necessarily increasing skew as much as sv does.</p>
</div>
</div>
<div class="section level2">
<h2 id="interactively-exploring-parameters-with-the-shiny-app">Interactively Exploring Parameters with the Shiny App<a class="anchor" aria-label="anchor" href="#interactively-exploring-parameters-with-the-shiny-app"></a>
</h2>
</div>
<div class="section level2">
<h2 id="interactively-exploring-parameters-with-the-shiny-app-1">Interactively Exploring Parameters with the Shiny App<a class="anchor" aria-label="anchor" href="#interactively-exploring-parameters-with-the-shiny-app-1"></a>
</h2>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Across-trial parameter variability is a critical extension to the
basic DDM. By allowing drift rate, starting point, and non-decision time
to fluctuate from trial to trial, the model can more accurately capture
the richness and complexity of human decision-making behavior,
particularly the full shape of RT distributions and the patterns of
error responses.</p>
<p>The functions simulate_diffusion_trial_variable() and
simulate_diffusion_experiment_variable() in your R scripts provide the
tools to explore these more nuanced aspects of the DDM.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dogukan Nami Oztas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
